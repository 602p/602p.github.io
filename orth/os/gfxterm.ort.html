<html>
		<head>
			<title>gfxterm.ort</title>
			<link rel="stylesheet" type="text/css" href="syntax.css">
		</head>
		<body>
			<pre>

<a href="./mbdata.ort.html"><span class="orth-T_IMPORT">import mbdata</span></a><br/><a href="./framebuffer.ort.html"><span class="orth-T_IMPORT">import framebuffer</span></a><br/><a href="./font.ort.html"><span class="orth-T_IMPORT">import &quot;font/font.ort&quot;</span></a><br/><br/><span class="orth-T_TYPEDECL">type</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_NAME">VGABox</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_IS">is</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_PACKED">packed</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">byte</span> <span class="orth-T_VAR_DECL-name">char</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">byte</span> <span class="orth-T_VAR_DECL-name">attrs</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT-type">VGABox</span> <span class="orth-T_ARGLIST_ELEMENT-name">a</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT-type">VGABox</span> <span class="orth-T_ARGLIST_ELEMENT-name">b</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">VGABox:__eq__</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">bool</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">a</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">char</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_NAME">b</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">char</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_BLOCK_END_ON_ELIF">eli</span><span class="orth-T_IF_ELIF">f</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">a</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">attrs</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_NAME">b</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">attrs</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">bool</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT-type">VGABox</span> <span class="orth-T_ARGLIST_ELEMENT-name">a</span><span class="orth-T_ARGLIST_SEPERATOR">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_ARGLIST_ELEMENT-type">VGABox</span> <span class="orth-T_ARGLIST_ELEMENT-name">b</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">VGABox:__ne__</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">bool</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">a</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">char</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_NAME">b</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">char</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">a</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">attrs</span><span class="orth-T_BINARY_OPERATOR">==</span><span class="orth-T_NAME">b</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">attrs</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">bool</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">bool</span><br/><span class="orth-T_TYPEDECL_END">endtype</span><br/><br/><span class="orth-T_TYPEDECL">type</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_NAME">VGATextModeEmulator</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_TYPEDECL_IS">is</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">ptr</span> <span class="orth-T_VAR_DECL-name">text_fb</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">ptr</span> <span class="orth-T_VAR_DECL-name">old_text_fb</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">bufsz</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">Framebuffer</span> <span class="orth-T_VAR_DECL-name">out</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">vga_w</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">vga_h</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">fontsz</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT-type">Framebuffer</span> <span class="orth-T_ARGLIST_ELEMENT-name">screen</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">VGATextModeEmulator::new</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">VGATextModeEmulator</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">VGATextModeEmulator</span> <span class="orth-T_VAR_DECL-name">new</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">malloc</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTRINSIC">@sizeof(VGATextModeEmulator)@</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">VGATextModeEmulator</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">8</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">vga_w</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">screen</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">w</span><span class="orth-T_BINARY_OPERATOR">/</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">vga_h</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">screen</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">h</span><span class="orth-T_BINARY_OPERATOR">/</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">bsz</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">vga_w</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">vga_h</span><span class="orth-T_BINARY_OPERATOR">+</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">2</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">bufsz</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">bsz</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">text_fb</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">malloc</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">bsz</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">old_text_fb</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">malloc</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">bsz</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">memset</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">text_fb</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">bsz</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">byte</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">memset</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">old_text_fb</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">bsz</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">byte</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">new</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">out</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">screen</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">new</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT-type">VGATextModeEmulator</span> <span class="orth-T_ARGLIST_ELEMENT-name">e</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">VGATextModeEmulator:clear</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">out</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME-accessor">fill</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_COMMA">,</span><span class="orth-T_INTEGER_LITERAL">0</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT-type">VGATextModeEmulator</span> <span class="orth-T_ARGLIST_ELEMENT-name">e</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">VGATextModeEmulator:update</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">y</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">x</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">pos</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">ptr</span> <span class="orth-T_VAR_DECL-name">colors</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">get_colors</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">char</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">bgcolor</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_VAR_DECL-type">int</span> <span class="orth-T_VAR_DECL-name">fgcolor</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHILE_START">while</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">&lt;</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">vga_h</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">x</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_INTEGER_LITERAL">0</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHILE_START">while</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">&lt;</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">vga_w</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">pos</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">vga_w</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">2</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_BINARY_OPERATOR">+</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">2</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_IF_START">if</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">text_fb</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME-accessor">offset</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">pos</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">VGABox</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_BINARY_OPERATOR">!=</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">old_text_fb</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME-accessor">offset</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">pos</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">VGABox</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_BLOCK_DO">do</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">char</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">text_fb</span><span class="orth-T_LIST_START">[</span><span class="orth-T_NAME">pos</span><span class="orth-T_LIST_STOP">]</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">int</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">bgcolor</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">text_fb</span><span class="orth-T_LIST_START">[</span><span class="orth-T_NAME">pos</span><span class="orth-T_BINARY_OPERATOR">+</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_LIST_STOP">]</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">int</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_BINARY_OPERATOR">&gt;&gt;</span><span class="orth-T_INTEGER_LITERAL">4</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">3</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">fgcolor</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">text_fb</span><span class="orth-T_LIST_START">[</span><span class="orth-T_NAME">pos</span><span class="orth-T_BINARY_OPERATOR">+</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_LIST_STOP">]</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">int</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_BINARY_OPERATOR">&amp;</span><span class="orth-T_INTEGER_LITERAL">0b1111</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_INTEGER_LITERAL">3</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">out</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME-accessor">fillrect</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">colors</span><span class="orth-T_LIST_START">[</span><span class="orth-T_NAME">bgcolor</span><span class="orth-T_LIST_STOP">]</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">int</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">colors</span><span class="orth-T_LIST_START">[</span><span class="orth-T_NAME">bgcolor</span><span class="orth-T_BINARY_OPERATOR">+</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_LIST_STOP">]</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">int</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">colors</span><span class="orth-T_LIST_START">[</span><span class="orth-T_NAME">bgcolor</span><span class="orth-T_BINARY_OPERATOR">+</span><span class="orth-T_INTEGER_LITERAL">2</span><span class="orth-T_LIST_STOP">]</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">int</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">out</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME-accessor">drawchar</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">x</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><span class="orth-T_PAREN_CLOSE">)</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">y</span><span class="orth-T_BINARY_OPERATOR">*</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">fontsz</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">char</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">colors</span><span class="orth-T_LIST_START">[</span><span class="orth-T_NAME">fgcolor</span><span class="orth-T_LIST_STOP">]</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">int</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">colors</span><span class="orth-T_LIST_START">[</span><span class="orth-T_NAME">fgcolor</span><span class="orth-T_BINARY_OPERATOR">+</span><span class="orth-T_INTEGER_LITERAL">1</span><span class="orth-T_LIST_STOP">]</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">int</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">colors</span><span class="orth-T_LIST_START">[</span><span class="orth-T_NAME">fgcolor</span><span class="orth-T_BINARY_OPERATOR">+</span><span class="orth-T_INTEGER_LITERAL">2</span><span class="orth-T_LIST_STOP">]</span><span class="orth-T_CAST">|</span><span class="orth-T_NAME-cast-type">int</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">x</span><span class="orth-T_AUGASSIGN">+=</span><span class="orth-T_INTEGER_LITERAL">1</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">y</span><span class="orth-T_AUGASSIGN">+=</span><span class="orth-T_INTEGER_LITERAL">1</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_BLOCK_DONE">done</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">memcpy</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">text_fb</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">old_text_fb</span><span class="orth-T_COMMA">,</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_NAME">e</span><span class="orth-T_DOT">.</span><span class="orth-T_NAME-accessor">bufsz</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_RETURN">return</span><br/><span class="orth-T_TYPEDECL_END">endtype</span><br/><br/><span class="orth-T_VAR_DECL-type">VGATextModeEmulator</span> <span class="orth-T_VAR_DECL-name">console_emulator</span><br/><span class="orth-T_VAR_DECL-type">Framebuffer</span> <span class="orth-T_VAR_DECL-name">console_fb</span><br/><br/><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_ELEMENT-type">MultibootInfo</span> <span class="orth-T_ARGLIST_ELEMENT-name">mbinfo</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">init_emulator</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">console_fb</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">Framebuffer</span><span class="orth-T_DOUBLECOLON">::</span><span class="orth-T_NAME-accessor">from_mbinfo</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">mbinfo</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">console_emulator</span><span class="orth-T_ASSIGNMENT">=</span><span class="orth-T_NAME">VGATextModeEmulator</span><span class="orth-T_DOUBLECOLON">::</span><span class="orth-T_NAME-accessor">new</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_NAME">console_fb</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">console_emulator</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME-accessor">clear</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_RETURN">return</span><br/><br/><span class="orth-T_FUNCTIONDECL">function</span><span class="orth-T_ARGLIST_START">(</span><span class="orth-T_ARGLIST_END">)</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_NAME">_update_framebuffer</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURNS">-&gt;</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_RETURN_TYPE">void</span><span class="orth-T_WHITESPACE"> </span><span class="orth-T_FUNCTIONDECL_DOES">does</span><br/><span class="orth-T_WHITESPACE">	</span><span class="orth-T_NAME">console_emulator</span><span class="orth-T_COLON">:</span><span class="orth-T_NAME-accessor">update</span><span class="orth-T_PAREN_OPEN">(</span><span class="orth-T_PAREN_CLOSE">)</span><br/><span class="orth-T_RETURN">return</span><br/><span class="orth-T_WHITESPACE"> </span>

			</pre>
		</body>
	</html>